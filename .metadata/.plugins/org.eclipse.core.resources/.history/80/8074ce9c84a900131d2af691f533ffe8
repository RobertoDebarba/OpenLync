//Referencias:
//	
//	http://www.guj.com.br/articles/126

import java.io.BufferedReader;
import java.io.IOException;  
import java.io.InputStreamReader;
import java.io.PrintStream;  
import java.net.Socket;
import java.util.Scanner;

public class OpenLync_client {
	
	private static int portaEntrada;
	private static int portaSaida;  //TODO alterar demais locais que usam porta de saida
	
	public OpenLync_client() {
		portaEntrada = 7607;  //Define porta de entrada de dados; Servidor -> Cliente
		System.out.print("Digite o ip com o qual deseja se comunicar: ");
		Scanner scan = new Scanner(System.in);
		portaSaida = scan.nextInt();  // Define porta de sáida de dados; Cliente -> Servidor 
	}

	public static void main(String[] args) throws IOException {
		
		// Instancia objeto que cuidará da entrada de dados e manda para uma thread
		EntradaDados ed = new EntradaDados(portaEntrada);
		new Thread(ed).start();
		
		//Declaro o socket cliente  
        Socket s = null;  
          
        //Declaro a Stream de saida de dados  
        PrintStream ps = null;  
        
        BufferedReader in = new BufferedReader(new InputStreamReader(System.in)); 
        
        while (true) {
        	
        	try{  
        	
            	//Cria o socket com o recurso desejado na porta especificada  
            	s = new Socket("192.168.152.1",7605);  
            
            	//Cria a Stream de saida de dados  
                ps = new PrintStream(s.getOutputStream()); 
            	
	            System.out.print("Digite alguma mensagem: ");
	            String mensagem = in.readLine(); 
	              
	            //Imprime uma linha para a stream de saída de dados  
	            ps.println(mensagem);  
	            
	        //Trata possíveis exceções  
	        }catch(IOException e){  
	              
	            System.out.println("Algum problema ocorreu ao criar ou enviar dados pelo socket.");  
	          
	        }finally{  
	              
	            try{  
	                  
	                //Encerra o socket cliente  
	                s.close();  
	                  
	            }catch(IOException e){}  
	          
	        } 
        }
	}

}
